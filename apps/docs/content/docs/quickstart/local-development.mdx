---
title: Local Development
description: Day-to-day loop for running API, web, docs, and Postgres.
---

## Daily Startup

```bash
pnpm infra:up
cp .env.example .env
pnpm dev
```

## Workspace Commands

```bash
pnpm build      # build all JS workspaces
pnpm check      # static checks
pnpm lint       # lint checks
pnpm format:web # format frontend files
pnpm test       # workspace tests
```

## Rust Quality Gate

```bash
cargo fmt --all
cargo xcheck
cargo xclippy
cargo xtest
```

## App-Specific Loops

```bash
pnpm --filter @qryvanta/api dev
pnpm --filter @qryvanta/web dev
pnpm --filter @qryvanta/landing dev
pnpm --filter @qryvanta/docs dev
```

## Development CRM/ERP Seed

Populate a realistic tenant with CRM + ERP metadata and sample records:

```bash
pnpm dev:seed
```

The seed targets `DEV_DEFAULT_TENANT_ID` when set (from `.env`), creates/updates the tenant named `Northwind Industrial Group`, and upserts sample `account`, `contact`, `deal`, and `invoice` records.

It ensures seeded tenant identities and role assignments are in place, including full owner access through the system `tenant_owner` role.

Beyond records, the seed provisions a full model-driven tenant surface: `sales_hub` and `finance_ops` apps, entity bindings, curated forms, grid views, and app sitemaps.

Seeded local users:

- Admin: `admin@qryvanta.local` / `admin` (full tenant rights)
- Standard user: `user@qryvanta.local` / `admin` (worker-focused app access via `standard_user` role)

Default local ports:

- API: `http://localhost:3001`
- Web: `http://localhost:3000`
- Landing: `http://localhost:3003`
- Docs: `http://127.0.0.1:3002`

## Local Passkey Test

Use one hostname (`localhost`) for the web app and API while testing auth.

1. Set `FRONTEND_URL=http://localhost:3000`.
2. Set `NEXT_PUBLIC_API_BASE_URL=http://localhost:3001`.
3. Start apps with `pnpm dev`.
4. Open `http://localhost:3000/login`.
5. Enter a subject and bootstrap token, click **Bootstrap Session**.
6. Click **Enroll Passkey** and complete the browser/device prompt.
7. Click **Sign in with Passkey**.

## Guardrails

- Keep domain and application crates framework-agnostic.
- Keep HTTP behavior in `apps/api`.
- Keep WebAuthn/session behavior in API (BFF) and use cookie auth from web.
- Update docs whenever architecture or behavior changes.

## Daily Shutdown

```bash
pnpm infra:down
```
