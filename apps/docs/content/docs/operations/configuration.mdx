---
title: Configuration
description: Configuration strategy for local, staging, and production environments.
---

## Principles

- Configuration is externalized via environment variables.
- Defaults are developer-friendly but never assumed for production.
- Sensitive values must be sourced from secret managers or encrypted stores.

## Suggested Domains

- API server settings (host, port, CORS)
- Database connection and pool sizing
- Auth settings (issuer, signing keys, token lifetime)
- Worker execution settings (concurrency, retries, timeouts)
- Observability sinks (logs, metrics, tracing)

## Change Safety

- Prefer additive config evolution.
- Document required and optional values per release.
- Validate startup configuration and fail fast on invalid values.

## Phase 1 Environment Variables

| Variable | Required | Description |
| --- | --- | --- |
| `DATABASE_URL` | Yes | PostgreSQL connection string used by API and migrations |
| `API_HOST` | No | API bind host (`127.0.0.1` default) |
| `API_PORT` | No | API bind port (`3001` default) |
| `FRONTEND_URL` | No | Allowed CORS origin and post-login redirect target |
| `SESSION_SECRET` | Yes | Session secret (32+ chars) |
| `AUTH_BOOTSTRAP_TOKEN` | Yes | One-time bootstrap token for initial authenticated session setup |
| `DEV_DEFAULT_TENANT_ID` | No | Optional local-development tenant UUID used when bootstrap creates first membership |
| `WEBAUTHN_RP_ID` | No | WebAuthn relying party id (`localhost` default) |
| `WEBAUTHN_RP_ORIGIN` | No | WebAuthn relying party origin (`FRONTEND_URL` default) |
| `SESSION_COOKIE_SECURE` | No | Enforce secure session cookies (`false` default for local dev) |
| `TOTP_ENCRYPTION_KEY` | Yes (prod) | 64-char hex key used to encrypt stored TOTP secrets (`[0;32]` fallback only for local dev) |
| `EMAIL_PROVIDER` | No | Email adapter (`console` default, `smtp` for production delivery) |
| `SMTP_HOST` | Required if `EMAIL_PROVIDER=smtp` | SMTP server host (must be non-empty; startup fails fast if missing) |
| `SMTP_PORT` | Required if `EMAIL_PROVIDER=smtp` | SMTP server port (`u16`; startup fails on invalid values) |
| `SMTP_USERNAME` | Required if `EMAIL_PROVIDER=smtp` | SMTP username (must be non-empty) |
| `SMTP_PASSWORD` | Required if `EMAIL_PROVIDER=smtp` | SMTP password (must be non-empty) |
| `SMTP_FROM_ADDRESS` | Required if `EMAIL_PROVIDER=smtp` | Sender address used for auth/invite emails (must be non-empty and valid) |
| `NEXT_PUBLIC_API_BASE_URL` | No | Browser-facing API base URL for web app |

For local passkey and session stability, keep `FRONTEND_URL`, `WEBAUTHN_RP_ORIGIN`, and `NEXT_PUBLIC_API_BASE_URL` aligned to `localhost` hosts.

For production email operations, see `operations/email-delivery`.
