---
title: API Conventions
description: Consistent transport patterns for predictable integration behavior.
---

## Handler Responsibilities

Keep handlers focused on:

1. Request parsing
2. Application service calls
3. Response mapping
4. Error to HTTP translation

## Error Mapping

- `AppError::Validation` -> `400 Bad Request`
- `AppError::NotFound` -> `404 Not Found`
- `AppError::Conflict` -> `409 Conflict`
- `AppError::Forbidden` -> `403 Forbidden`
- `AppError::Internal` -> `500 Internal Server Error`

## Resource Design

- Prefer stable logical identifiers.
- Keep request/response DTOs explicit.
- Use predictable collection endpoints for list and create paths.
- Ensure API contracts remain versionable as metadata runtime expands.

## Security Admin Endpoints

- `GET /api/security/roles` lists tenant roles and grants.
- `POST /api/security/roles` creates custom roles.
- `GET /api/security/role-assignments` lists current subject-to-role mappings.
- `POST /api/security/role-assignments` assigns roles to existing tenant members.
- `POST /api/security/role-unassignments` removes role assignments.
- `GET /api/security/registration-mode` reads the tenant registration mode (`invite_only` or `open`).
- `PUT /api/security/registration-mode` updates tenant registration mode.
- `GET /api/security/audit-log?limit=50&offset=0&action=...&subject=...` lists filtered tenant audit entries.
