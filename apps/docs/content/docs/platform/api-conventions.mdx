---
title: API Conventions
description: Consistent transport patterns for predictable integration behavior.
---

This page is the source of truth for externally callable API routes documented in this site.

## Handler Contract

Keep handlers focused on:

1. Request parsing
2. Application service calls
3. Response mapping
4. Error to HTTP translation

## Error Mapping

- `AppError::Validation` -> `400 Bad Request`
- `AppError::NotFound` -> `404 Not Found`
- `AppError::Conflict` -> `409 Conflict`
- `AppError::Forbidden` -> `403 Forbidden`
- `AppError::Internal` -> `500 Internal Server Error`

## Route Design Rules

- Prefer stable logical identifiers.
- Keep request/response DTOs explicit.
- Use predictable collection endpoints for list and create paths.
- Keep compatibility in mind as metadata runtime grows.

## Metadata Runtime

- `GET /api/entities` lists metadata entities.
- `POST /api/entities` creates metadata entities.
- `GET /api/entities/:entity_logical_name/fields` lists draft fields.
- `POST /api/entities/:entity_logical_name/fields` creates/updates draft fields.
- `POST /api/entities/:entity_logical_name/publish` publishes immutable schema version.
- `GET /api/entities/:entity_logical_name/published` returns latest published schema.
- `GET /api/runtime/:entity_logical_name/records?limit=50&offset=0` lists runtime records.
- `POST /api/runtime/:entity_logical_name/records/query` queries runtime records with typed operators, alias-aware link entities, recursive `where` groups, sorting, and pagination.
- `POST /api/runtime/:entity_logical_name/records` creates runtime record.
- `GET /api/runtime/:entity_logical_name/records/:record_id` fetches one runtime record.
- `PUT /api/runtime/:entity_logical_name/records/:record_id` updates runtime record.
- `DELETE /api/runtime/:entity_logical_name/records/:record_id` deletes runtime record when no relation fields reference it.

## App Builder (Admin APIs)

- `GET /api/apps` lists tenant apps for administrators.
- `POST /api/apps` creates an app.
- `GET /api/apps/:app_logical_name/entities` lists app navigation bindings.
- `POST /api/apps/:app_logical_name/entities` saves app navigation binding and optional app-scoped presentation overrides (`form_field_logical_names`, `list_field_logical_names`, `default_view_mode`).
- `GET /api/apps/:app_logical_name/permissions` lists app role entity permissions.
- `PUT /api/apps/:app_logical_name/permissions` saves app role entity permissions.

## Workspace Runtime

- `GET /api/workspace/apps` lists apps accessible to the current subject.
- `GET /api/workspace/apps/:app_logical_name/navigation` lists worker-visible app entities.
- `GET /api/workspace/apps/:app_logical_name/entities/:entity_logical_name/capabilities` returns effective worker capabilities.
- `GET /api/workspace/apps/:app_logical_name/entities/:entity_logical_name/schema` returns published schema for worker forms.
- `GET|POST /api/workspace/apps/:app_logical_name/entities/:entity_logical_name/records` lists/creates records with app-scoped permissions.
- `POST /api/workspace/apps/:app_logical_name/entities/:entity_logical_name/records/query` queries records with app-scoped permissions using alias-aware runtime query grammar.
- `GET|PUT|DELETE /api/workspace/apps/:app_logical_name/entities/:entity_logical_name/records/:record_id` reads/writes/deletes records with app-scoped permissions.

## Automation

- `GET /api/workflows` lists workflow definitions.
- `POST /api/workflows` creates or updates a workflow definition.
- `POST /api/workflows/:workflow_logical_name/execute` executes a workflow manually with trigger payload.
- `GET /api/workflows/runs?workflow_logical_name=&limit=50&offset=0` lists workflow execution runs.
- `GET /api/workflows/runs/:run_id/attempts` lists attempt history for one workflow run.

Internal worker APIs:

- `POST /api/internal/worker/jobs/claim` claims queued workflow jobs for one worker identity.
- `POST /api/internal/worker/heartbeat` updates worker heartbeat and cycle counters.
- `GET /api/internal/worker/jobs/stats` returns aggregate queue and active worker metrics.

## Security Administration

- `GET /api/security/roles` lists tenant roles and grants.
- `POST /api/security/roles` creates custom roles.
- `GET /api/security/role-assignments` lists current subject-to-role mappings.
- `POST /api/security/role-assignments` assigns roles to existing tenant members.
- `POST /api/security/role-unassignments` removes role assignments.
- `GET /api/security/registration-mode` reads the tenant registration mode (`invite_only` or `open`).
- `PUT /api/security/registration-mode` updates tenant registration mode.
- `GET /api/security/audit-log?limit=50&offset=0&action=...&subject=...` lists filtered tenant audit entries.
